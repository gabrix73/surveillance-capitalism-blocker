# Apache2 Configuration - Block Commercial Crawlers, AI Bots, and Malicious Scrapers
# File: /etc/apache2/conf-available/blockbots.conf
# Enable: sudo a2enconf blockbots && sudo systemctl reload apache2
# Updated: 2025-10-22

<IfModule mod_rewrite.c>
    RewriteEngine On

    # ========================================
    # BLOCK AI BOTS AND LLM CRAWLERS
    # ========================================

    # OpenAI Bots
    RewriteCond %{HTTP_USER_AGENT} GPTBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ChatGPT-User [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} OAI-SearchBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Plugin-User [NC,OR]

    # Anthropic (Claude) Bots
    RewriteCond %{HTTP_USER_AGENT} anthropic-ai [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ClaudeBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} claude-web [NC,OR]

    # Google AI (Gemini/Bard)
    RewriteCond %{HTTP_USER_AGENT} Google-Extended [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} GoogleOther [NC,OR]

    # Perplexity AI
    RewriteCond %{HTTP_USER_AGENT} PerplexityBot [NC,OR]

    # Meta AI
    RewriteCond %{HTTP_USER_AGENT} Meta-ExternalAgent [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} FacebookBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} facebookexternalhit [NC,OR]

    # Amazon AI
    RewriteCond %{HTTP_USER_AGENT} Amazonbot [NC,OR]

    # Bytedance/TikTok AI (most aggressive crawler)
    RewriteCond %{HTTP_USER_AGENT} Bytespider [NC,OR]

    # Deepseek AI
    RewriteCond %{HTTP_USER_AGENT} DeepseekBot [NC,OR]

    # Mistral AI
    RewriteCond %{HTTP_USER_AGENT} MistralAI-User [NC,OR]

    # Cohere AI
    RewriteCond %{HTTP_USER_AGENT} cohere-ai [NC,OR]

    # AI2 Bot
    RewriteCond %{HTTP_USER_AGENT} ai2bot [NC,OR]

    # Diffbot
    RewriteCond %{HTTP_USER_AGENT} Diffbot [NC,OR]

    # Common Crawl (used for AI training)
    RewriteCond %{HTTP_USER_AGENT} CCBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} CCResearchBot [NC,OR]

    # Omgili Bot
    RewriteCond %{HTTP_USER_AGENT} omgili [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} omgilibot [NC,OR]

    # Webz.io (AI training)
    RewriteCond %{HTTP_USER_AGENT} Webzio-Extended [NC,OR]

    # Applebot-Extended (AI training)
    RewriteCond %{HTTP_USER_AGENT} Applebot-Extended [NC,OR]

    # ImagesiftBot
    RewriteCond %{HTTP_USER_AGENT} ImagesiftBot [NC,OR]

    # ========================================
    # BLOCK COMMERCIAL SEARCH ENGINE CRAWLERS
    # ========================================

    # Google Bots
    RewriteCond %{HTTP_USER_AGENT} Googlebot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Googlebot-Image [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Googlebot-News [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Googlebot-Video [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Storebot-Google [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Google-InspectionTool [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} GoogleProber [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Google-Read-Aloud [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Mediapartners-Google [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} AdsBot-Google [NC,OR]

    # Microsoft Bing Bots
    RewriteCond %{HTTP_USER_AGENT} Bingbot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} BingPreview [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} msnbot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} msnbot-media [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} adidxbot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} BingLocalSearch [NC,OR]

    # Yahoo Bots
    RewriteCond %{HTTP_USER_AGENT} Slurp [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} yahoo-slurp [NC,OR]

    # Yandex Bots (Russian search engine)
    RewriteCond %{HTTP_USER_AGENT} YandexBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} YandexImages [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} YandexVideo [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} YandexNews [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} YandexAccessibilityBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} YandexMobileBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} YaDirectFetcher [NC,OR]

    # Baidu Bots (Chinese search engine)
    RewriteCond %{HTTP_USER_AGENT} Baiduspider [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Baiduspider-video [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Baiduspider-image [NC,OR]

    # Apple Bots
    RewriteCond %{HTTP_USER_AGENT} Applebot [NC,OR]

    # Naver (Korean search engine)
    RewriteCond %{HTTP_USER_AGENT} Yeti [NC,OR]

    # Sogou (Chinese search engine)
    RewriteCond %{HTTP_USER_AGENT} Sogou [NC,OR]

    # 360 Spider (Chinese search engine)
    RewriteCond %{HTTP_USER_AGENT} 360Spider [NC,OR]

    # Seznam (Czech search engine)
    RewriteCond %{HTTP_USER_AGENT} SeznamBot [NC,OR]

    # ========================================
    # BLOCK SEO CRAWLERS AND ANALYTICS
    # ========================================

    # Ahrefs (SEO crawler - very aggressive)
    RewriteCond %{HTTP_USER_AGENT} AhrefsBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} AhrefsSiteAudit [NC,OR]

    # Semrush (SEO crawler)
    RewriteCond %{HTTP_USER_AGENT} SemrushBot [NC,OR]

    # Moz crawlers
    RewriteCond %{HTTP_USER_AGENT} MJ12bot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} DotBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} rogerbot [NC,OR]

    # BLEXBot
    RewriteCond %{HTTP_USER_AGENT} BLEXBot [NC,OR]

    # SEOkicks
    RewriteCond %{HTTP_USER_AGENT} SEOkicks [NC,OR]

    # MegaIndex
    RewriteCond %{HTTP_USER_AGENT} MegaIndex [NC,OR]

    # LinkpadBot
    RewriteCond %{HTTP_USER_AGENT} LinkpadBot [NC,OR]

    # Screaming Frog
    RewriteCond %{HTTP_USER_AGENT} Screaming\ Frog [NC,OR]

    # Exabot
    RewriteCond %{HTTP_USER_AGENT} Exabot [NC,OR]

    # ========================================
    # BLOCK SOCIAL MEDIA BOTS
    # ========================================

    # Facebook/Meta
    RewriteCond %{HTTP_USER_AGENT} facebot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WhatsApp [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} InstagramBot [NC,OR]

    # Twitter/X
    RewriteCond %{HTTP_USER_AGENT} Twitterbot [NC,OR]

    # LinkedIn
    RewriteCond %{HTTP_USER_AGENT} LinkedInBot [NC,OR]

    # Pinterest
    RewriteCond %{HTTP_USER_AGENT} Pinterestbot [NC,OR]

    # Telegram
    RewriteCond %{HTTP_USER_AGENT} TelegramBot [NC,OR]

    # ========================================
    # BLOCK MALICIOUS SCRAPERS AND TOOLS
    # ========================================

    # Email harvesters
    RewriteCond %{HTTP_USER_AGENT} EmailCollector [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} EmailSiphon [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} EmailWolf [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ExtractorPro [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} CherryPicker [NC,OR]

    # Content scrapers
    RewriteCond %{HTTP_USER_AGENT} WebCopier [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WebStripper [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} SiteSnagger [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WebZIP [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} HTTrack [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Teleport [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} TeleportPro [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WebReaper [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WebSauger [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WebWhacker [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} GetRight [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Offline\ Explorer [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Offline\ Navigator [NC,OR]

    # Download managers
    RewriteCond %{HTTP_USER_AGENT} Go-Ahead-Got-It [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} GetWeb [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Go!Zilla [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Download\ Demon [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Download\ Wonder [NC,OR]

    # Generic scrapers
    RewriteCond %{HTTP_USER_AGENT} Scrapy [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} python-requests [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Wget [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} curl [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} libwww-perl [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Nutch [NC,OR]

    # Vulnerable scanners
    RewriteCond %{HTTP_USER_AGENT} Nikto [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} sqlmap [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Acunetix [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} w3af [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} dirbuster [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} masscan [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} nmap [NC,OR]

    # Aggressive crawlers
    RewriteCond %{HTTP_USER_AGENT} SurveyBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} DataparkSearch [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Zeus [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} RepoMonkey [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} CazoodleBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} DiscoBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} EasouSpider [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Ezooms [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} FeedFetcher [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} Genieo [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} WBSearchBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} ZoomBot [NC,OR]

    # Archive bots (if you don't want archiving)
    RewriteCond %{HTTP_USER_AGENT} ia_archiver [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} archive\.org_bot [NC,OR]

    # Spam bots
    RewriteCond %{HTTP_USER_AGENT} SpamBot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} spbot [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} spam [NC,OR]

    # Last condition WITHOUT [OR] flag
    RewriteCond %{HTTP_USER_AGENT} LinkWalker [NC]

    # Block all matching user agents with 403 Forbidden
    RewriteRule .* - [F,L]

</IfModule>

# ========================================
# ALTERNATIVE METHOD: Using SetEnvIf
# ========================================
# Uncomment this section if you prefer SetEnvIf method instead of mod_rewrite
# Note: Only use ONE method (either mod_rewrite above OR SetEnvIf below)

#<IfModule mod_setenvif.c>
#    # AI Bots
#    SetEnvIfNoCase User-Agent "GPTBot" bad_bot
#    SetEnvIfNoCase User-Agent "ClaudeBot" bad_bot
#    SetEnvIfNoCase User-Agent "anthropic-ai" bad_bot
#    SetEnvIfNoCase User-Agent "ChatGPT-User" bad_bot
#    SetEnvIfNoCase User-Agent "Bytespider" bad_bot
#    SetEnvIfNoCase User-Agent "CCBot" bad_bot
#    SetEnvIfNoCase User-Agent "PerplexityBot" bad_bot
#
#    # Commercial Search Engines
#    SetEnvIfNoCase User-Agent "Googlebot" bad_bot
#    SetEnvIfNoCase User-Agent "Bingbot" bad_bot
#    SetEnvIfNoCase User-Agent "Slurp" bad_bot
#    SetEnvIfNoCase User-Agent "YandexBot" bad_bot
#    SetEnvIfNoCase User-Agent "Baiduspider" bad_bot
#
#    # Deny access to bad bots
#    <RequireAll>
#        Require all granted
#        Require not env bad_bot
#    </RequireAll>
#</IfModule>

# ========================================
# LOGGING (Optional - useful for debugging)
# ========================================

# Log blocked requests to separate file
# Uncomment to enable:
# CustomLog ${APACHE_LOG_DIR}/blocked_bots.log combined env=bad_bot

# ========================================
# NOTES
# ========================================
#
# Installation:
#   sudo cp blockbots.conf /etc/apache2/conf-available/
#   sudo a2enconf blockbots
#   sudo apache2ctl configtest
#   sudo systemctl reload apache2
#
# Verification:
#   curl -A "GPTBot" https://www.virebent.art/
#   # Should return: 403 Forbidden
#
#   curl -A "DuckDuckBot" https://www.virebent.art/
#   # Should return: 200 OK
#
# Disable:
#   sudo a2disconf blockbots
#   sudo systemctl reload apache2
#
# This configuration blocks:
#   - All major AI/LLM crawlers (20+)
#   - Commercial search engines (Google, Bing, Yahoo, Yandex, Baidu, etc.)
#   - SEO crawlers (Ahrefs, Semrush, Moz, etc.)
#   - Social media bots (Facebook, Twitter, LinkedIn, etc.)
#   - Malicious scrapers and email harvesters
#   - Vulnerability scanners
#   - Download managers and content rippers
#
# Privacy-focused crawlers that are NOT blocked:
#   - DuckDuckBot (DuckDuckGo)
#   - BraveBot (Brave Search)
#   - MojeekBot (Mojeek)
#   - Qwantbot (Qwant)
#   - Swisscows Crawler (Swisscows)
#   - yacybot (YaCy)
#   - searx (Searx)
#
